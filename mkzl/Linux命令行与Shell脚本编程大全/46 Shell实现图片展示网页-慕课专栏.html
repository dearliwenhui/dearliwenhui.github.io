<html><head><meta charset="utf-8"><title>46 Shell实现图片展示网页-慕课专栏</title>
			<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
			<meta name="renderer" content="webkit">
			<meta property="qc:admins" content="77103107776157736375">
			<meta property="wb:webmaster" content="c4f857219bfae3cb">
			<meta http-equiv="Access-Control-Allow-Origin" content="*">
			<meta http-equiv="Cache-Control" content="no-transform ">
			<meta http-equiv="Cache-Control" content="no-siteapp">
			<link rel="apple-touch-icon" sizes="76x76" href="https://www.imooc.com/static/img/common/touch-icon-ipad.png">
			<link rel="apple-touch-icon" sizes="120x120" href="https://www.imooc.com/static/img/common/touch-icon-iphone-retina.png">
			<link rel="apple-touch-icon" sizes="152x152" href="https://www.imooc.com/static/img/common/touch-icon-ipad-retina.png">
			<link href="https://moco.imooc.com/captcha/style/captcha.min.css" rel="stylesheet">
			<link rel="stylesheet" href="https://www.imooc.com/static/moco/v1.0/dist/css/moco.min.css?t=201907021539" type="text/css">
			<link rel="stylesheet" href="https://www.imooc.com/static/lib/swiper/swiper-3.4.2.min.css?t=201907021539">
			<link rel="stylesheet" href="../zhuanlanChapter-less.css?v=201907051055" type="text/css">
			<link charset="utf-8" rel="stylesheet" href="https://www.imooc.com/static/lib/ueditor/themes/imooc/css/ueditor.css?v=201907021539"><link rel="stylesheet" href="https://www.imooc.com/static/lib/baiduShare/api/css/share_style0_16.css?v=6aba13f0.css"></head>
			<body><div id="main">


<div class="main-con hide-menu">
    <!-- 左侧菜单 & 索引 -->
    
    <div class="right-content" style="padding-left: 0px;">
        <div class="container clearfix" id="top" style="width: 1134px; display: block;">
            
            
            <div class="center_con js-center_con l" style="width: 1134px;">
                <div class="article-con">
                                            <!-- 买过的阅读 -->
                        

                    
                    <div class="art-title" style="margin-top: 0px;">
                        46 Shell实现图片展示网页
                    </div>
                    <div class="art-info clearfix">
                        
                        <span class="l">
                            更新时间：2019-08-15 09:44:15
                        </span>
                    </div>
                    <div class="art-top">
                                                <img src="https://img3.mukewang.com/5d4d07220001c08506400359.jpg" alt="">
                                                                        <div class="famous-word-box">
                            <img src="https://www.imooc.com/static/img/column/bg-l.png" alt="" class="bg1 bg">
                            <img src="https://www.imooc.com/static/img/column/bg-r.png" alt="" class="bg2 bg">
                            <div class="famous-word">散步促进我的思想。我的身体必须不断运动，脑筋才会开动起来。 <p class="author">—— 卢梭</p></div>
                        </div>
                                            </div>
                    <div class="art-content js-lookimg">
                        <div id="article_content">
                            <div class="cl-preview-section"><h3 id="内容简介">内容简介</h3>
</div><div class="cl-preview-section"><ol>
<li style="font-size: 20px; line-height: 38px;">前言</li>
<li style="font-size: 20px; line-height: 38px;">成果展示</li>
<li style="font-size: 20px; line-height: 38px;">生成缩略图</li>
<li style="font-size: 20px; line-height: 38px;">我的答案</li>
<li style="font-size: 20px; line-height: 38px;">可能的优化</li>
</ol>
</div><div class="cl-preview-section"><h3 id="前言">1. 前言</h3>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">上一课 <a href="">带你玩转Linux和Shell编程 | 第五部分第七课：一朝Shell函数倾，斗转星移任我行</a> 中我们学习了 Shell 中很关键的知识点 ：函数。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">既然我们已经基本学完了 Shell 的基础知识，是时候实战演练一下了。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">在这个练习中，我们将会综合运用之前学习过的一些 Shell 和 Linux 的知识点。别忘了，我们在 Shell 程序中是可以调用 Linux 命令的，例如：</p>
</div><div class="cl-preview-section"><pre><code>ls
cp
mv
grep
cut
mkdir
sort
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">还有“管道、流、重定向”等等。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">你也许还会在使用一些命令时忘了如何用，那你可以查阅命令的使用手册。</p>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">本练习要实现的项目是：<br>
创建一个网页，这个网页展示一系列图片 （有点像一个画廊，英语叫 Gallery ），而展示的图片是存放在本地的一个文件夹里的。</p>
</blockquote>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">说起来总比做起来简单，你将会发现这是个不小的挑战。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">话休絮烦，我们开始吧。</p>
</div><div class="cl-preview-section"><h3 id="成果展示">2. 成果展示</h3>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">首先，我们给脚本文件起名叫 gallery.sh （gallery 是英语“画廊”的意思）。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">对于这个练习的第一个版本，我们暂时把脚本文件放在一个目录中，这个目录包含了要展示的所有图片。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我们可以创建一个目录，叫 gallery：</p>
</div><div class="cl-preview-section"><pre><code>mkdir gallery
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">进入 gallery 目录，创建我们的 gallery.sh 文件：</p>
</div><div class="cl-preview-section"><pre><code>cd gallery
vim gallery.sh
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我们先不急着编写我们的 gallery.sh 脚本文件，可以先做一些准备工作。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">你可以在 gallery 这个目录中随便添加一些图片。我提供给你这 8 张图片（都是 900 x 500 像素的），当然了，你完全可以用自己的图片。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img.mukewang.com/5d4d0afe0001066109000500.jpg" data-original="//img.mukewang.com/5d4d0afe0001066109000500.jpg" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img.mukewang.com/5d4d0b0d0001eb9709000500.jpg" data-original="//img.mukewang.com/5d4d0b0d0001eb9709000500.jpg" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img.mukewang.com/5d4d0b1300011b0009000500.png" data-original="//img.mukewang.com/5d4d0b1300011b0009000500.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img.mukewang.com/5d4d0b210001892e09000500.jpg" data-original="//img.mukewang.com/5d4d0b210001892e09000500.jpg" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img.mukewang.com/5d4d0b290001749809000500.png" data-original="//img.mukewang.com/5d4d0b290001749809000500.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img.mukewang.com/5d4d0b2f00010e4b09000500.jpg" data-original="//img.mukewang.com/5d4d0b2f00010e4b09000500.jpg" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img.mukewang.com/5d4d0b3800010d9809000500.jpg" data-original="//img.mukewang.com/5d4d0b3800010d9809000500.jpg" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img.mukewang.com/5d4d0b3e0001c3fb09000500.jpg" data-original="//img.mukewang.com/5d4d0b3e0001c3fb09000500.jpg" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">gallery.sh 这个脚本会为我们生成一个 HTML 文件，这个 HTML 文件就是一个网页文件，用来展示这些图片。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">因此，这个脚本需要依次做以下的事：</p>
</div><div class="cl-preview-section"><ol>
<li style="font-size: 20px; line-height: 38px;">根据目录中的每张图片，生成对应缩略图；</li>
<li style="font-size: 20px; line-height: 38px;">生成一个 HTML 文件，把缩略图都插入其中；</li>
<li style="font-size: 20px; line-height: 38px;">给每张缩略图绑定一个链接，会链接到原始图片。</li>
</ol>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">为了写出这个脚本，需要有一些前端的网络知识，比如 HTML。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">当然了，如果你没有前端的知识也不要紧，跟着我写就可以了。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">给出一个 HTML5 的基本的图片例子代码：</p>
</div><div class="cl-preview-section"><pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;body&gt;
    &lt;h2&gt;Spectacular Mountain&lt;/h2&gt;
    &lt;img class="lazyload" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" data-original="pic_mountain.jpg" alt="Mountain View" style="width:304px;height:228px;" &gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
</div><div class="cl-preview-section"><h4 id="最终成品" style="font-size: 26px;">最终成品</h4>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">你将要用脚本来生成的网页是像下面这样的：</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img.mukewang.com/5d4d0b4b0001a81e24280822.png" data-original="//img.mukewang.com/5d4d0b4b0001a81e24280822.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">你点击这 8 张图片中的任意一张，都会跳转到原始图片，例如我点击第一张缩略图：</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img.mukewang.com/5d4d0b530001ee2710000625.png" data-original="//img.mukewang.com/5d4d0b530001ee2710000625.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">当然了，这只是初级版本，你可以优化。编程不就是循序渐进的嘛，首先做出一个可以运行的版本，之后再“添砖加瓦”。</p>
</div><div class="cl-preview-section"><h2 id="生成缩略图" style="font-size: 30px;">3. 生成缩略图</h2>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我们在本系列课程中还没有学过如何为图片生成缩略图。</p>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">缩略图：<br>
缩略图的英文是 thumbnail。代表网页上或计算机中图片经压缩方式处理后的小图，其中通常会包含指向完整尺寸的图片的超链接。</p>
</blockquote>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">为了不让你纠结，我就告诉你我们要用到的命令吧。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">其实有一个 convert 命令，就可以帮助我们从图片生成缩略图。Ubuntu 里自带了这个命令。</p>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">convert 是英语“转换”的意思。</p>
</blockquote>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">convert 命令有好多参数，可以用来做很多事情。对于生成缩略图，我们需要用到的参数就是 -thumbnail 。前面说了，thumbnail 就是“缩略图”的意思。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我们的脚本接收一个参数，就是要生成的 HTML 的文件名。如果没有给出文件名，那么就用默认的 gallery.html。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">好了，如果你有基本的 HTML 的知识，那么已经可以开始写了。如果还不知道 HTML，可以去看一下 W3C 推出的官方教程：</p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">英文版 ：<a href="https://www.w3schools.com/html/default.asp%E3%80%82">https://www.w3schools.com/html/default.asp。</a></li>
<li style="font-size: 20px; line-height: 38px;">中文版 ：<a href="http://www.w3school.com.cn/html/index.asp%E3%80%82">http://www.w3school.com.cn/html/index.asp。</a></li>
</ul>
</div><div class="cl-preview-section"><h3 id="我的答案">4. 我的答案</h3>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我给出我的解法。你的代码当然不必和我一样，但我想基本原理是类似的。</p>
</div><div class="cl-preview-section"><pre><code>#!/bin/bash

# Verification of parameter（验证参数）
# If no parameter, use a default value（如果没有给出参数，那么用默认值 gallery.html ）
if [ -z $1 ]
then
    output='gallery.html'
else
    output=$1
fi

# Preparation of files and folders（准备文件和目录）
echo '' &gt; $output

if [ ! -e thumbnails ]
then
    mkdir thumbnails
fi

# Beginning of HTML（HTML 文件的开头）
echo '&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;My Gallery&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p&gt;' &gt;&gt; $output

# Generation of thumbnails and the HTML web page（生成图片的缩略图和 HTML 的页面主体）
for image in `ls *.jpg *.png *.jpeg *.gif 2&gt;/dev/null`
do
    convert $image -thumbnail '200x200&gt;' thumbnails/$image
    echo '      &lt;a href="'$image'"&gt;&lt;img class="lazyload" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" data-original="thumbnails/'$image'" alt=""/&gt;&lt;/a&gt;' &gt;&gt; $output
done

# End of HTML（HTML 文件的结尾）
echo '    &lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;' &gt;&gt; $output
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我们依顺序解释一下上面的代码：</p>
</div><div class="cl-preview-section"><ol>
<li style="font-size: 20px; line-height: 38px;">首先，我们确认用户有没有输入表示输出的 HTML 文件名字的参数：如果输入了参数，那么输出的 HTML 文件就被命名为用户输入的那个名字；如果没有输入参数，那么用默认的脚本名字 gallery.html；</li>
<li style="font-size: 20px; line-height: 38px;">确保脚本文件被清空。就是那行 <code>echo '' &gt; $output</code> 所做的工作；</li>
<li style="font-size: 20px; line-height: 38px;">如果要存放图片缩略图的目录（取名叫 thumbnails）不存在，那么创建它；</li>
<li style="font-size: 20px; line-height: 38px;">把 HTML 文件的开头写入脚本文件；</li>
<li style="font-size: 20px; line-height: 38px;">做一个 for 循环，遍历当前目录下所有常用的图片格式的文件。对每一个被遍历到图片，用 convert 命令生成缩略图（用 <code>-thumbnail</code> 参数），缩略图尺寸是 200 x 200 像素（但最终生成的缩略图尺寸并不一定是 200 x 200 像素，而可能是等比例缩小的），缩略图都存放到 thumbnails 这个子目录下；</li>
<li style="font-size: 20px; line-height: 38px;">代码中的 200x200 后面紧跟的 <code>&gt;</code> 符号是为了达到“如果原始图片的尺寸已经小于 200 x 200 像素，那么就直接用原始图片，不需要为之生成缩略图”的目的。参见 convert 命令的文档（ <code>man convert</code> ）；</li>
<li style="font-size: 20px; line-height: 38px;">对于每一个被 for 循环遍历到的图片，我们将其标签用 echo 写入脚本，并添加链接到原始图片的链接；</li>
<li style="font-size: 20px; line-height: 38px;">把 HTML 文件的结尾写入脚本文件。</li>
</ol>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">执行这个脚本文件后，会生成 thumbnails 文件夹：</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img.mukewang.com/5d4d0b650001d00617580618.png" data-original="//img.mukewang.com/5d4d0b650001d00617580618.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">生成的 HTML 文件内容类似如下：</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img.mukewang.com/5d4d0b6d00019b7016421136.png" data-original="//img.mukewang.com/5d4d0b6d00019b7016421136.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">你可以打开 gallery 目录，用鼠标双击 gallery.html 文件，就会用默认的浏览器来打开，在我的 Ubuntu 系统里是用火狐浏览器来打开的。</p>
</div><div class="cl-preview-section"><h3 id="可能的优化">5. 可能的优化</h3>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">正如我之前所说，我们给出的解方是最基础的，你可以在此基础上做不少优化。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">下面提出几点优化的设想：</p>
</div><div class="cl-preview-section"><ol>
<li style="font-size: 20px; line-height: 38px;">对网页的样式做一定优化，需要用到 CSS 文件；</li>
<li style="font-size: 20px; line-height: 38px;">使用户能够选择包含要展示的图片的目录。对于我们上面的程序，要展示的图片必须和脚本文件在同一个目录下；</li>
<li style="font-size: 20px; line-height: 38px;">为脚本添加一个参数，用于指定缩略图尺寸；</li>
<li style="font-size: 20px; line-height: 38px;">在每张缩略图下面显示图片的名字；</li>
<li style="font-size: 20px; line-height: 38px;">在每张缩略图下面显示图片的其它信息，例如：图片原始尺寸、最近一次修改图片的时间等等。要获取这些信息，需要调用 convert 命令。</li>
</ol>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">要完成这些优化，你需要自己去查找一些手册，看一些文档，做一些测试。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">但是请相信我，你会很享受这种学习的过程。如果不经历这样自我学习的过程，何来提高呢？对吧。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">今天的课就到这里，一起加油吧！</p>
</div>}
                        </div>
                    </div>
                                            <!-- 买过的阅读 -->
                        <div class="art-next-prev clearfix">
                                                                                                <!-- 已买且开放 或者可以试读 -->
                                    <a href="/read/39/article/539">
                                                                    <div class="prev l clearfix">
                                        <div class="icon l">
                                            <i class="imv2-arrow3_l"></i>
                                        </div>
                                        <p>
                                            45 一朝Shell函数倾，斗转星移任我行
                                        </p>
                                    </div>
                                </a>
                                                                                                                            <!-- 已买且开放 或者可以试读 -->
                                    <a href="/read/39/article/541">
                                                                    <div class="next r clearfix">
                                        <p>
                                            47 用Shell做统计练习
                                        </p>
                                        <div class="icon r">
                                            <i class="imv2-arrow3_r"></i>
                                        </div>

                                    </div>
                                </a>
                                                    </div>
                                    </div>
                <div class="comments-con js-comments-con" id="coments_con">
                </div>

                
            </div>
            
            
            

        </div>
    </div>
</div>

<div class="modal modal-jiaQun-new hide" id="modal-jiaQun">
    <div class="inner" style="">
        <div class="modal-close js-close-jiaQun">
            <i class="imv2-close"></i>
        </div>
        <div class="content">
            <img src="https://img.mukewang.com/5d5a70bc000165cb05400598.jpg">
            <div class="right-info">
                <div class="title">
                    扫码加入慕课前沿技术核心用户群
                </div>
                <div class="desc">
                                            <p class="mb6">验证信息：<span id="joincode">1907221925272456</span><span class="copy js-copy-joincode">复制</span></p>
                                        <p class="mb6">QQ讨论群号：812552418</p>
                                            <p>QQ群URL：<a href="https://jq.qq.com/?_wv=1027&amp;k=50iMJcL" target="_blank">点击访问</a></p>
                                    </div>
            </div>
            <p class="tip">若遇到搜索不到QQ群或加群失败，请联系客服邮箱:kf@imooc.com</p>
        </div>
    </div>
</div>
 
<!-- 专栏介绍页专栏评价 -->

<!-- 专栏介绍页底部三条评价 -->

<!-- 专栏阅读页弹层目录和介绍页页面目录 -->

<!-- 专栏阅读页发布回复 -->

<!-- 专栏阅读页发布评论 -->

<!-- 专栏阅读页底部评论 -->

<!-- 专栏阅读 单个 评论 -->

<!-- 新增回复和展开三条以外回复 -->

<!-- 立即订阅的弹窗 -->












</div></body></html>