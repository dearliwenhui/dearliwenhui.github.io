<html><head><meta charset="utf-8"><title>34 文件传输，潇洒同步-慕课专栏</title>
			<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
			<meta name="renderer" content="webkit">
			<meta property="qc:admins" content="77103107776157736375">
			<meta property="wb:webmaster" content="c4f857219bfae3cb">
			<meta http-equiv="Access-Control-Allow-Origin" content="*">
			<meta http-equiv="Cache-Control" content="no-transform ">
			<meta http-equiv="Cache-Control" content="no-siteapp">
			<link rel="apple-touch-icon" sizes="76x76" href="https://www.imooc.com/static/img/common/touch-icon-ipad.png">
			<link rel="apple-touch-icon" sizes="120x120" href="https://www.imooc.com/static/img/common/touch-icon-iphone-retina.png">
			<link rel="apple-touch-icon" sizes="152x152" href="https://www.imooc.com/static/img/common/touch-icon-ipad-retina.png">
			<link href="https://moco.imooc.com/captcha/style/captcha.min.css" rel="stylesheet">
			<link rel="stylesheet" href="https://www.imooc.com/static/moco/v1.0/dist/css/moco.min.css?t=201907021539" type="text/css">
			<link rel="stylesheet" href="https://www.imooc.com/static/lib/swiper/swiper-3.4.2.min.css?t=201907021539">
			<link rel="stylesheet" href="https://static.mukewang.com/static/css/??base.css,common/common-less.css?t=2.5,column/zhuanlanChapter-less.css?t=2.5,course/inc/course_tipoff-less.css?t=2.5?v=201907051055" type="text/css">
			<link charset="utf-8" rel="stylesheet" href="https://www.imooc.com/static/lib/ueditor/themes/imooc/css/ueditor.css?v=201907021539"><link rel="stylesheet" href="https://www.imooc.com/static/lib/baiduShare/api/css/share_style0_16.css?v=6aba13f0.css"></head>
			<body><div id="main">

<div class="container clearfix" id="top" style="display: block; width: 1134px;">
    
    <div class="center_con js-center_con l" style="width: 1134px;">
        <div class="article-con">
                            <!-- 买过的阅读 -->
                <div class="map">
                    <a href="/read" target="_blank"><i class="imv2-feather-o"></i></a>
                    <a href="/read/39" target="_blank">Linux命令行与Shell脚本编程大全</a>
                    <a href="" target="_blank">
                        <span>
                            / 4-4 34 文件传输，潇洒同步
                        </span>
                    </a>
                </div>

            


            <div class="art-title" style="margin-top: 0px;">
                34 文件传输，潇洒同步
            </div>
            <div class="art-info">
                
                <span>
                    更新时间：2019-07-31 10:13:30
                </span>
            </div>
            <div class="art-top">
                                <img src="https://img4.mukewang.com/5d3ecaa70001163306400359.jpg" alt="">
                                                <div class="famous-word-box">
                    <img src="https://www.imooc.com/static/img/column/bg-l.png" alt="" class="bg1 bg">
                    <img src="https://www.imooc.com/static/img/column/bg-r.png" alt="" class="bg2 bg">
                    <div class="famous-word">青年是学习智慧的时期，中年是付诸实践的时期。 <p class="author">—— 卢梭</p></div>
                </div>
                            </div>
            <div class="art-content js-lookimg">
                <div><div class="cl-preview-section"><h3 id="内容简介">内容简介</h3>
</div><div class="cl-preview-section"><ol>
<li style="font-size: 20px; line-height: 38px;">前言</li>
<li style="font-size: 20px; line-height: 38px;">wget ：下载文件</li>
<li style="font-size: 20px; line-height: 38px;">scp ：网间拷贝</li>
<li style="font-size: 20px; line-height: 38px;">ftp &amp; sftp ：传输文件</li>
<li style="font-size: 20px; line-height: 38px;">rsync ：同步备份</li>
<li style="font-size: 20px; line-height: 38px;">总结</li>
<li style="font-size: 20px; line-height: 38px;">第四部分第五课预告</li>
</ol>
</div><div class="cl-preview-section"><h3 id="前言">1. 前言</h3>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">上两课 <a href="">带你玩转Linux和Shell编程 | 第四部分第二课：连接远程终端和对称加密，安全快捷</a> 和 <a href="">带你玩转Linux和Shell编程 | 第四部分第三课：非对称加密和使用SSH建立安全连接</a> 的内容有点“饱满”，大家可能“消化”得比较辛苦。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">这一课的内容相对简单，所以我们慢慢“享用”。但是这一课要学的几个命令还是很有用的，特别是 rsync。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">经过上一课的学习，我们已经知道如何远程连接到其它电脑了。从今以后，你就可以在自己的电脑上运行命令，来控制远方的另一台电脑了，很酷吧。</p>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">我们继续探究 Linux 的奇幻网络世界。这个网络世界比较特别，也许你已经有所体会：<br>
前辈们做了大量努力，靠加密方法来保证网络间传输的数据的安全，以防我们私人的信息泄露，例如密码。</p>
</blockquote>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">这一课我们来学习文件传输，主要分为以下几方面：</p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">如何下载文件</li>
<li style="font-size: 20px; line-height: 38px;">如何连接到 FTP，读取、下载文件</li>
<li style="font-size: 20px; line-height: 38px;">如何安全地拷贝文件</li>
</ul>
</div><div class="cl-preview-section"><h3 id="wget-：下载文件">2. wget ：下载文件</h3>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我们就从一个简单的命令开始吧，就是：wget 。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">它可以使我们直接从终端控制台下载文件，只需要给出文件的 HTTP 或 FTP 地址。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">命令格式：</p>
</div><div class="cl-preview-section"><pre><code>wget [参数] [URL地址]
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">例如：</p>
</div><div class="cl-preview-section"><pre><code>wget http://cdimage.debian.org/debian-cd/9.9.0/amd64/iso-cd/debian-9.9.0-amd64-netinst.iso
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">就会开始从 <a href="http://cdimage.debian.org/debian-cd/9.9.0/amd64/iso-cd/">http://cdimage.debian.org/debian-cd/9.9.0/amd64/iso-cd/</a><br>
上下载 debian-9.9.0-amd64-netinst.iso 这个文件。</p>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">如果要停止下载，只需要按 Ctrl +C。</p>
</blockquote>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">可以看到下方会出现一个进度条，显示下载进度：</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img src="http://img.mukewang.com/5d3ec37b0001c9a321621398.png" alt="图片描述" data-original="http://img.mukewang.com/5d3ec37b0001c9a321621398.png" class="" style="cursor: pointer;"></p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">64 % 表示已下载百分之六四。</li>
<li style="font-size: 20px; line-height: 38px;">18.7MB/s 是下载速度，表示 117 MB 每秒。</li>
<li style="font-size: 20px; line-height: 38px;">eta 是预计剩余时间，此处是 6 秒。</li>
</ul>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">那么，怎么事先获得供 wget 下载的地址呢？</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">你可以用浏览器（比如 firefox、chrome），找到要下载的文件，然后在文件上点击鼠标右键，左键点击"复制链接地址"，如下图：</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img src="http://img.mukewang.com/5d3ec3850001ba9610321102.png" alt="图片描述" data-original="http://img.mukewang.com/5d3ec3850001ba9610321102.png" class="" style="cursor: pointer;"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">然后黏贴到 wget 命令的地址参数中就可以了。</p>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">wget 非常稳定，它在带宽很窄的情况下和不稳定网络中有很强的适应性。<br>
如果是由于网络的原因下载失败，wget 会不断的尝试，直到整个文件下载完毕。<br>
如果是服务器打断下载过程，它会再次联到服务器上从停止的地方继续下载。<br>
这对从那些限定了链接时间的服务器上下载大文件非常有用。</p>
</blockquote>
</div><div class="cl-preview-section"><h4 id="继续中断的下载" style="font-size: 26px;">继续中断的下载</h4>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">要继续一个中断的下载，只要在相同的下载命令中加入 -c 参数，例如：</p>
</div><div class="cl-preview-section"><pre><code>wget -c http://cdimage.debian.org/debian-cd/9.9.0/amd64/iso-cd/debian-9.9.0-amd64-netinst.iso
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">c 是英语 continue 的缩写，表示“继续”。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">wget 有非常多的参数选项，我们不能逐一列举。可以参看 wget 的使用手册：</p>
</div><div class="cl-preview-section"><pre><code>man wget
</code></pre>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">wget 的一个优点是会显示下载的进度，稍后我们会学习的 ftp 命令则不会显示下载进度。</p>
</blockquote>
</div><div class="cl-preview-section"><h3 id="scp-：网间拷贝">3. scp ：网间拷贝</h3>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我们以前的课程中学习过 cp 命令，它用于在自己的电脑上拷贝文件。cp 是英语 copy 的缩写，表示"拷贝"。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">scp 是Secure CoPy 的缩写，表示“安全拷贝”。这个命令可以使我们通过网络，把文件从一台电脑拷贝到另一台。当然，拷贝的信息是安全的，正如它的名字所示。</p>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">也有一个命令 rcp，是 Remote CoPy 的缩写，表示"远程拷贝"。它也可以做同样的事，但是信息没有得到安全保护，不推荐。</p>
</blockquote>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">scp 使用起来有点类似上两课学过的 SSH（Secure SHell）。这并不是巧合，因为 scp 是基于 SSH 的原理来运作的。SSH 首先会在两台通过网络连接的电脑之间创建一条安全通信的管道（如上两课所示），scp 就利用这条管道安全地拷贝文件。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">scp 的基本命令格式如下：</p>
</div><div class="cl-preview-section"><pre><code>scp source_file destination_file
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">其中:</p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">source_file 表示源文件，就是被拷贝的文件；</li>
<li style="font-size: 20px; line-height: 38px;">destination_file 表示目标文件，就是拷贝产生的文件。</li>
</ul>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">这两个文件都可以用如下方式来表示：</p>
</div><div class="cl-preview-section"><pre><code>user@ip:file_name
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">其中 user 是登录名，ip 是域名（例如 <a href="http://google.com">google.com</a>）或 ip 地址（例如 216.58.206.238），file_name 是文件路径，不要忘了中间的 @ 号和冒号（:）。</p>
</div><div class="cl-preview-section"><h4 id="从自己电脑拷贝文件到另一台电脑" style="font-size: 26px;">从自己电脑拷贝文件到另一台电脑</h4>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">这很简单，例如：</p>
</div><div class="cl-preview-section"><pre><code>scp image.png oscar@89.231.45.67:/home/oscar/images/
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">表示把我的电脑中当前文件夹下的 image.png 文件拷贝到远程电脑（ip 地址是 89.231.45.67。当然了，这是假想的 ip 地址）的用户 oscar 的 /home/oscar/images 目录下，文件名不变（还是 image.png，你也可以改名字）。如下图所示：</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img src="http://img.mukewang.com/5d3ec3910001ea2013220756.png" alt="图片描述" data-original="http://img.mukewang.com/5d3ec3910001ea2013220756.png" class="" style="cursor: pointer;"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">当然了，scp 会请求你输入远程电脑（ip 地址是 89.231.45.67）的用户 oscar 的密码。输入密码，回车，就开始拷贝了。</p>
</div><div class="cl-preview-section"><h4 id="从另一台电脑拷贝文件到自己电脑" style="font-size: 26px;">从另一台电脑拷贝文件到自己电脑</h4>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">类似的用法，例如：</p>
</div><div class="cl-preview-section"><pre><code>scp oscar@89.231.45.67:/home/oscar/images/image.png file_changed_name.png
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">表示从远程电脑（ip 地址是 89.231.45.67）的用户 oscar 的 /home/oscar/images 目录下把 image.png 拷贝到我的电脑中当前文件夹下，并改名为 file_changed_name.png（不改名也可以）。如下图所示：</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img src="http://img.mukewang.com/5d3ec39c00018cb014060806.png" alt="图片描述" data-original="http://img.mukewang.com/5d3ec39c00018cb014060806.png" class="" style="cursor: pointer;"></p>
</div><div class="cl-preview-section"><h4 id="修改端口" style="font-size: 26px;">修改端口</h4>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">上述命令中，我们并没有指定用哪个端口，只指定了 ip 地址。默认的端口号是 22，和 SSH 一样。我们也可以修改端口号，用 -P 参数（p 是 port 的缩写，表示“端口”）。例如：</p>
</div><div class="cl-preview-section"><pre><code>scp -P 7821 oscar@89.231.45.67:/home/oscar/images/image.png .
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">表示从远程电脑（ip 地址是89.231.45.67，端口 7821）的用户 oscar 的 /home/oscar/images 目录下把 image.png 拷贝到我的电脑中当前文件夹下，名字不变。此处用点号（.）表示当前目录。</p>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">注意：上一课中，SSH 修改端口号使用 -p 参数，p 是小写。而 scp修改端口号使用 -P 参数，P 是大写。</p>
</blockquote>
</div><div class="cl-preview-section"><h3 id="ftp--sftp-：传输文件">4. ftp &amp; sftp ：传输文件</h3>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">FTP 是 File Transfer Protocol 的缩写，表示“文件传输协议”。顾名思义，就是用于传输文件的。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">FTP 协议已经有些年纪了，1985 年诞生，比我还老呢。FTP 现在仍然是传输文件的最常用协议。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">正所谓“廉颇老矣，尚能饭否”；人家是“FTP 当道，宝刀未老”。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">使用 FTP 主要分为两种情况：</p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">从公共的 FTP 服务器下载文件。一般来说，当你点击浏览器上的下载链接时，浏览器就以自动和透明的方式来完成这个操作。这种情况下，连接是匿名的；</li>
<li style="font-size: 20px; line-height: 38px;">从私有的 FTP 服务器上传或下载文件。当我们从服务器出租商处租用一台服务器作为个人网站之用时，出租商通常会给我们一个 FTP 的登录名和密码，我们可以连接，以上传及下载文件。这种情况下，连接是需要身份验证的。</li>
</ul>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">因为并不是每个读者都有自己私人的 FTP 服务器，所以下面演示的时候，我们会连接到公共的 FTP 服务器。当然，如果你想要连接到私人 FTP 服务器，方法是类似的。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我们这里使用纯命令行的形式来操作。当然了，也存在不少优秀的 FTP 软件，可以提供图形操作界面，例如著名的 <a href="https://filezilla-project.org/">FileZilla</a></p>
</div><div class="cl-preview-section"><h4 id="连接到-ftp-服务器" style="font-size: 26px;">连接到 FTP 服务器</h4>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我们试着连接到 Debian 的 镜像 FTP 服务器，可以在这里找到各个国家的地址：<a href="https://www.debian.org/mirror/list">https://www.debian.org/mirror/list</a> 。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">比如我可以试试 Debian 在法国的 FTP 服务器：<a href="http://ftp.fr.debian.org">ftp.fr.debian.org</a> 。当然了，你可以选择你想要使用的 FTP 服务器地址。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">要连接到 FTP 服务器，方法很简单，运行以下命令：</p>
</div><div class="cl-preview-section"><pre><code>ftp -p ftp.fr.debian.org
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">此处我在 ftp 命令之后用了 -p 这个参数，p 是 passive 的缩写，表示“被动的”。如果不加这个参数，在 <a href="http://ftp.fr.debian.org">ftp.fr.debian.org</a> 这个服务器上不能使用 FTP 的命令。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">这是 FTP 的一种模式，暂时我们不深入讲解为什么要加 -p 参数，有兴趣可以参看这个关于 passive 模式的 <a href="https://bkso.baidu.com/item/PASV%20mode">百度百科</a>。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">Debian 的 FTP 服务器应该会有所回应，并向你请求输入用户名和密码。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">对于公共的 FTP 服务器，用户名（Name）一般都填写 anonymous （表示“匿名的”）。密码（Password）你随便输入什么都会被接受。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">登录成功后，会看到类似以下信息：</p>
</div><div class="cl-preview-section"><pre><code>230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt;
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img src="http://img.mukewang.com/5d3ec3a9000125dc12320670.png" alt="图片描述" data-original="http://img.mukewang.com/5d3ec3a9000125dc12320670.png" class="" style="cursor: pointer;"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">现在你有了命令提示符了，就是那个：</p>
</div><div class="cl-preview-section"><pre><code>ftp&gt;
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">你就可以输入 FTP 命令了。</p>
</div><div class="cl-preview-section"><h4 id="在-ftp-服务器中操作" style="font-size: 26px;">在 FTP 服务器中操作</h4>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">好消息：你在 FTP 服务器上可以使用的命令基本和我们到目前为止学习的 Linux 命令是一样的。</p>
</blockquote>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">例如：</p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">ls：列出当前目录的文件</li>
<li style="font-size: 20px; line-height: 38px;">pwd：显示当前目录的路径</li>
<li style="font-size: 20px; line-height: 38px;">cd：转换目录</li>
</ul>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">你也可以试试其它命令。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img src="http://img.mukewang.com/5d3ec3b10001bc9021661396.png" alt="图片描述" data-original="http://img.mukewang.com/5d3ec3b10001bc9021661396.png" class="" style="cursor: pointer;"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">可以看到，我用 ls 命令可以列出目录下文件。用 <code>cd debian</code> 命令切换到了 debian 这个子目录里面，又用 ls 命令列出包含的文件。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">当然了，你在浏览器里面用 HTTP 协议也是可以登录这个 Debian 服务器的：<a href="http://ftp.fr.debian.org">http://ftp.fr.debian.org</a>。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img src="http://img.mukewang.com/5d3ec3ba0001e28610320808.png" alt="图片描述" data-original="http://img.mukewang.com/5d3ec3ba0001e28610320808.png" class="" style="cursor: pointer;"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">同样可以访问 debian 这个子目录里的文件：</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img src="http://img.mukewang.com/5d3ec3c20001db7211421262.png" alt="图片描述" data-original="http://img.mukewang.com/5d3ec3c20001db7211421262.png" class="" style="cursor: pointer;"></p>
</div><div class="cl-preview-section"><h4 id="文件传输" style="font-size: 26px;">文件传输</h4>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">如果你想上传及下载文件，需要知道两个命令：</p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">put：用于上传文件。put 是英语“放入”的意思。</li>
<li style="font-size: 20px; line-height: 38px;">get：用于下载文件。get 是英语“获得”的意思。</li>
</ul>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">如下图所示：</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img src="http://img.mukewang.com/5d3ec3cb0001148612880556.png" alt="图片描述" data-original="http://img.mukewang.com/5d3ec3cb0001148612880556.png" class="" style="cursor: pointer;"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我们来下载一个文件试试（README），这个文件就位于 debian 这个子目录里，所以你事先需要进入 debian 这个子目录（<code>cd debian</code>）：</p>
</div><div class="cl-preview-section"><pre><code>ftp&gt; get README
local: README remote: README
227 Entering Passive Mode (212,27,32,66,130,207)
150 Opening BINARY mode data connection for README (1181 bytes).
226 Transfer complete.
1181 bytes received in 0.00 secs (9.0103 MB/s)
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img src="http://img.mukewang.com/5d3ec3d8000178a921601194.png" alt="图片描述" data-original="http://img.mukewang.com/5d3ec3d8000178a921601194.png" class="" style="cursor: pointer;"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">下载完毕，README 文件现在位于你的 Ubuntu 系统的当前目录了。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">你连接到 FTP 服务器之后，又想要在自己的电脑上运行命令，怎么办呢？</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">只要在命令前加一个感叹号就可以了，例如：</p>
</div><div class="cl-preview-section"><pre><code>!ls
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">就会在自己电脑上执行 ls 命令，而不是在 FTP 服务器上执行。例如，执行 <code>!ls</code> 命令之后，我们可以看到在自己电脑的当前目录下已经有了刚从 FTP 服务器下载下来的 README 文件：</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img src="http://img.mukewang.com/5d3ec3e100018be119680814.png" alt="图片描述" data-original="http://img.mukewang.com/5d3ec3e100018be119680814.png" class="" style="cursor: pointer;"></p>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">passive 模式的时候，如果一段时间没有操作，连接可能会断开，只需要重新连接即可。</p>
</blockquote>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">如果我想用 put 命令给这个公共 FTP 服务器来传输文件，则会出现“Permission denied”的错误，表示“权限被否决”，因为我没有权限给这个 FTP 服务器写入文件，毕竟我是匿名登录，而且公共的 FTP 服务器如果任由写入文件的话，那早就乱套了。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img src="http://img.mukewang.com/5d3ec3e90001c92812580222.png" alt="图片描述" data-original="http://img.mukewang.com/5d3ec3e90001c92812580222.png" class="" style="cursor: pointer;"></p>
</div><div class="cl-preview-section"><h4 id="其它的-ftp-命令" style="font-size: 26px;">其它的 FTP 命令</h4>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">还有好些其它的 FTP 命令，我们就不逐一列举了。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">用 man ftp 来看看其它可用的命令吧。你会发现，并不是所有的命令都与你到目前学过的 Linux 命令是一样的。例如，删除文件不是用 rm 命令，而是 delete 命令。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">要从 FTP 服务器断开连接，你可以用 Ctrl + D 组合键。也可以用 bye、exit 或 quit 命令，效果是一样的。</p>
</div><div class="cl-preview-section"><h4 id="sftp：安全加密的-ftp" style="font-size: 26px;">sftp：安全加密的 ftp</h4>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">ftp 命令虽然方便，但是有一个致命缺点：不安全，数据不是加密传输的。任何人，只要连接到同一个网络，可以想办法截取到你传输的数据，或者你的密码。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">因此，我们需要请出 sftp。sftp 是 Secure FTP 的缩写。表示“安全的FTP”。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">sftp 也是基于 SSH 的，所以登录需要用户名和密码，用法如下：</p>
</div><div class="cl-preview-section"><pre><code>sftp user@ip
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">例如：</p>
</div><div class="cl-preview-section"><pre><code>sftp oscar@xxx.com
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">一旦你输入用户名和密码，连接上之后，其它操作和 ftp 是一样的，只不过通信被加密了，更安全。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">用 man sftp 来看看其它可用的命令和参数吧。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">上述命令中，我们并没有指定用哪个端口，只指定了 ip 地址。默认的端口号是 22，和 SSH 一样。我们也可以修改端口号，用 -oPort 参数。例如：</p>
</div><div class="cl-preview-section"><pre><code>sftp -oPort 3592 oscar@89.231.45.67
</code></pre>
</div><div class="cl-preview-section"><h3 id="rsync-：同步备份">5. rsync ：同步备份</h3>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">rsync 命令易于使用，功能很强大。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">rsync 是一个小程序，需要安装，系统一般默认没有这个命令（但最新版 Ubuntu 系统自带了）：</p>
</div><div class="cl-preview-section"><pre><code>sudo apt install rsync
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">rsync 命令使我们可以同步两个目录，不管这两个目录位于同一台电脑还是不同的电脑（用网络连接）。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">rsync 应该是最常用于“增量备份”的命令了吧。什么是“增量备份”呢？</p>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">增量备份（incremental backup）是备份的一种类型，指在一次全备份或上一次增量备份后，以后每次的备份只需备份与前一次相比增加或者被修改的文件。</p>
</blockquote>
</div><div class="cl-preview-section"><h4 id="备份有什么好处呢？" style="font-size: 26px;">备份有什么好处呢？</h4>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">想象一下，假如你不备份文件，那么一旦你的个人电脑“遭遇不测”，例如坏了、被偷等等，那么你的数据就找不回来了。<br>
如果有写了几十页的论文在里面，那“哭倒长城”都有可能啊。<br>
我的几个朋友就有过这样惨痛的经历。</p>
</blockquote>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我自己一直有备份的习惯，而且我备份不止会在一个地方。有的重要文件，会备份到移动硬盘，电脑的本地其它硬盘、邮箱等等，危机意识是很重要的。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">所以备份很重要。假如你把你电脑上的文件备份到远程服务器上，那么如下图所示：</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img src="http://img.mukewang.com/5d3ec3f30001c70b11320638.png" alt="图片描述" data-original="http://img.mukewang.com/5d3ec3f30001c70b11320638.png" class="" style="cursor: pointer;"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">用 rsync 来进行备份，是非常方便的。假如，你把自己的用户家目录都备份到服务器上，也许有十几个 G 的内容。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">第一次备份时，需要传输这整整十几个 G 的内容。但是以后呢，只需要传输新增或修改的内容就够了，不需要再传一遍。这就是 rsync 的强大之处，所谓“增量备份”的好处。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img src="http://img.mukewang.com/5d3ec3fe0001cd7512920826.png" alt="图片描述" data-original="http://img.mukewang.com/5d3ec3fe0001cd7512920826.png" class="" style="cursor: pointer;"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">如上图所示，我用 rsync 只传输了新的那个文件，其它的并没有再传输。</p>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">rsync 就好像更智能的 scp 命令。</p>
</blockquote>
</div><div class="cl-preview-section"><h4 id="备份到同一台电脑的其它目录" style="font-size: 26px;">备份到同一台电脑的其它目录</h4>
</div><div class="cl-preview-section"><pre><code>rsync -arv Images/ backups/
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">以上命令，将 Images 目录下的所有文件备份到 backups 目录下。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">-arv 参数分别表示：</p>
</div><div class="cl-preview-section"><ul>
<li style="font-size: 20px; line-height: 38px;">-a：保留文件的所有信息，包括权限、修改日期等等。a 是 archive 的缩写，是“归档”的意思；</li>
<li style="font-size: 20px; line-height: 38px;">-r：递归调用，表示子目录的所有文件也都包括。r 是 recursive 的缩写，是“递归的”的意思；</li>
<li style="font-size: 20px; line-height: 38px;">-v：冗余模式，输出详细操作信息。v 是 verbose 的缩写，是“冗余的”的意思。</li>
</ul>
</div><div class="cl-preview-section"><h4 id="删除文件" style="font-size: 26px;">删除文件</h4>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">默认地，rsync 在同步时并不会删除目标目录的文件。例如你的源目录（被同步目录）中删除了一个文件，但是用 rsync 同步时，它并不会删除同步目录中的相同文件。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">如果要使 rsync 也同步删除操作。那么可以这么做：</p>
</div><div class="cl-preview-section"><pre><code>rsync -arv --delete Images/ backups/
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">加上 --delete 参数就可以了。delete 是英语“删除”的意思。</p>
</div><div class="cl-preview-section"><h4 id="备份到另一台电脑的目录" style="font-size: 26px;">备份到另一台电脑的目录</h4>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">例如：</p>
</div><div class="cl-preview-section"><pre><code>rsync -arv --delete Images/ oscar@89.231.45.67:backups/
</code></pre>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">是不是很简单呢。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">至于更多参数，可以用 man rsync 学习。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">当然，rsync 的强大之处绝不止于此。</p>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">你可以自己配置 rsync，使得它从指定目录（可以是多个目录）备份到指定的 ip 地址的目录下，而且可以指定哪些类型文件是要备份的，哪些类型不要备份，然后把这一长串命令统一用 Shell 脚本来写成一个文件（例如取名叫 backup），使之可执行（用 <code>chmod +x</code> 命令），再把这个文件的路径添加到 PATH 中。</p>
</blockquote>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">这样你以后不论在哪个目录下输入 backup，rsync 就帮你自动同步该目录了，非常帅气。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">至于怎么做，就算是留给大家的课后兴趣作业咯。</p>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">提示：可以自己百度或 Google，例如“Ubuntu下 rsync 配置”。</p>
</blockquote>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">或者你可以等学了第五部分的 Shell 编程之后再来尝试。</p>
</div><div class="cl-preview-section"><h3 id="总结">6. 总结</h3>
</div><div class="cl-preview-section"><ol>
<li style="font-size: 20px; line-height: 38px;">wget 命令可以下载文件；</li>
<li style="font-size: 20px; line-height: 38px;">为了将文件从一台电脑拷贝到另一台电脑，我们可以使用 scp 命令。它使用上一课提到的 SSH，因此传输是加密的，非常安全；</li>
<li style="font-size: 20px; line-height: 38px;">我们可以用 ftp 命令来连接到一个 FTP 服务器，就可以上传及下载文件了；</li>
<li style="font-size: 20px; line-height: 38px;">sftp 和 ftp 命令类似，但是它用了 SSH，所以传输的信息是加密的；</li>
<li style="font-size: 20px; line-height: 38px;">rsync 命令可以同步同一台电脑或两台不同电脑上的两个文件（夹）的内容，用 rsync 命令来备份文件特别方便。</li>
</ol>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">今天的课就到这里，一起加油吧！</p>
</div></div>
            </div>
                            <!-- 买过的阅读 -->
                <div class="art-next-prev clearfix">
                                                                        <!-- 已买且开放 或者可以试读 -->
                            <a href="/read/39/article/527">
                                                    <div class="prev l clearfix">
                                <div class="icon l">
                                    <i class="imv2-arrow3_l"></i>
                                </div>
                                <p>
                                    33 非对称加密和使用SSH建立安全连接
                                </p>
                            </div>
                        </a>
                                                                                            <!-- 已买且开放 或者可以试读 -->
                            <a href="/read/39/article/529">
                                                    <div class="next r clearfix">
                                <p>
                                    35 IP地址和分析网络
                                </p>
                                <div class="icon r">
                                    <i class="imv2-arrow3_r"></i>
                                </div>

                            </div>
                        </a>
                                    </div>
                    </div>
        <div class="comments-con js-comments-con" id="coments_con">
        </div>



    </div>
    
    
    

</div>
 
<!-- 专栏介绍页专栏评价 -->

<!-- 专栏介绍页底部三条评价 -->

<!-- 专栏阅读页弹层目录和介绍页页面目录 -->

<!-- 专栏阅读页发布回复 -->

<!-- 专栏阅读页发布评论 -->

<!-- 专栏阅读页底部评论 -->

<!-- 专栏阅读 单个 评论 -->

<!-- 新增回复和展开三条以外回复 -->

<!-- 立即订阅的弹窗 -->












</div></body></html>