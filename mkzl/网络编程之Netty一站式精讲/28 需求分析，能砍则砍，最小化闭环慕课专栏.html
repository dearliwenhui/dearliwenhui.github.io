<html><head><meta charset="utf-8"><title>28 需求分析，能砍则砍，最小化闭环-慕课专栏</title>
			<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
			<meta name="renderer" content="webkit">
			<meta property="qc:admins" content="77103107776157736375">
			<meta property="wb:webmaster" content="c4f857219bfae3cb">
			<meta http-equiv="Access-Control-Allow-Origin" content="*">
			<meta http-equiv="Cache-Control" content="no-transform ">
			<meta http-equiv="Cache-Control" content="no-siteapp">
			<link rel="apple-touch-icon" sizes="76x76" href="https://www.imooc.com/static/img/common/touch-icon-ipad.png">
			<link rel="apple-touch-icon" sizes="120x120" href="https://www.imooc.com/static/img/common/touch-icon-iphone-retina.png">
			<link rel="apple-touch-icon" sizes="152x152" href="https://www.imooc.com/static/img/common/touch-icon-ipad-retina.png">
			<link href="https://moco.imooc.com/captcha/style/captcha.min.css" rel="stylesheet">
			<link rel="stylesheet" href="https://www.imooc.com/static/moco/v1.0/dist/css/moco.min.css?t=201907021539" type="text/css">
			<link rel="stylesheet" href="https://www.imooc.com/static/lib/swiper/swiper-3.4.2.min.css?t=201907021539">
			<link rel="stylesheet" href="https://static.mukewang.com/static/css/??base.css,common/common-less.css?t=2.5,column/zhuanlanChapter-less.css?t=2.5,course/inc/course_tipoff-less.css?t=2.5?v=201907051055" type="text/css">
			<link charset="utf-8" rel="stylesheet" href="https://www.imooc.com/static/lib/ueditor/themes/imooc/css/ueditor.css?v=201907021539"><link rel="stylesheet" href="https://www.imooc.com/static/lib/baiduShare/api/css/share_style0_16.css?v=6aba13f0.css"></head>
			<body><div id="main">


<div class="main-con hide-menu">
    <!-- 左侧菜单 & 索引 -->
    
    <div class="right-content" style="padding-left: 0px;">
        <div class="container clearfix" id="top" style="width: 1134px; display: block;">
            
            
            <div class="center_con js-center_con l" style="width: 1134px;">
                <div class="article-con">
                                            <!-- 买过的阅读 -->
                        

                    
                    <div class="art-title" style="margin-top: 0px;">
                        28 需求分析，能砍则砍，最小化闭环
                    </div>
                    <div class="art-info clearfix">
                        
                        <span class="l">
                            更新时间：2020-08-18 10:22:45
                        </span>
                    </div>
                    <div class="art-top">
                                                <img src="https://img4.sycdn.imooc.com/5f0596af00018a2006400359.jpg" alt="">
                                                                        <div class="famous-word-box">
                            <img src="https://www.imooc.com/static/img/column/bg-l.png" alt="" class="bg1 bg">
                            <img src="https://www.imooc.com/static/img/column/bg-r.png" alt="" class="bg2 bg">
                            <div class="famous-word">天才就是长期劳动的结果。——牛顿<p></p></div>
                        </div>
                                            </div>
                    <div class="art-content js-lookimg">
                        <div id="article_content">
                            <div class="cl-preview-section"><h1 id="前言">前言</h1>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">你好，我是彤哥。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">上一节，我们一起学习了软件开发的基本步骤，并结合我多年的工作经验做了一些补充和说明。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">本节，我们就运用上一节学习到的知识，从需求分析的角度详细介绍我们实战项目做什么。</p>
</div><div class="cl-preview-section"><h1 id="实战选题">实战选题</h1>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">其实，当初在考虑使用什么选题作为 Netty 的实战项目的时候，我是很纠结的。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">使用 Netty 写一个 RPC 框架？</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">使用 Netty 做一个 Http 服务？</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">使用 Netty 做一个游戏？</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">使用 Netty 做一个连接池？</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">使用 Netty 做一个异步的 Http Client？</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">使用 Netty 做一个 IM 聊天软件？</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">这些选题，我统统考虑过，而且有些东西我还真的写过，最终，我决定使用 Netty 做一个游戏，那么，我为什么选择做一个游戏呢？</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我想先分析我不选择其它种类的原因：</p>
</div><div class="cl-preview-section"><ol>
<li style="font-size: 20px; line-height: 38px;">RPC 框架，有很经典的 Dubbo 框架了；</li>
<li style="font-size: 20px; line-height: 38px;">Http 服务，有刚出世不久的 Spring WebFlux 或者 Spring Cloud Gateway 了；</li>
<li style="font-size: 20px; line-height: 38px;">连接池，有 Redis 非常好用的 Lettuce 或者 Redisson 了；</li>
<li style="font-size: 20px; line-height: 38px;">异步 Http Client，有 async-http-client 了；</li>
<li style="font-size: 20px; line-height: 38px;">IM 聊天软件，某度一搜一大把；</li>
</ol>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">基于以上原因，我决定不选择它们来作为实战项目，但是，我为什么敢选择游戏呢？</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">因为，我就是做棋牌游戏出身的，我对棋牌游戏这种基于房间制的游戏的架构设计和业务处理非常熟悉，我有信心把这个实战项目讲好讲深，甚至很多细节我也会讲到位，而且，我相信很多同学对游戏编程可能会非常感兴趣，就像当初的我一样，所以，最终，我选择了棋牌游戏作为本次课程的实战项目。</p>
</div><div class="cl-preview-section"><blockquote>
<p style="font-size: 20px; line-height: 38px;">这里有个词叫作 “房间制”，它是什么意思呢？</p>
<p style="font-size: 20px; line-height: 38px;">房间制，通俗一点解释，就是把几个玩家关到一个房间里，他们的游戏范围只限于这个房间，不会涉及到其它房间。常见的房间制游戏有，棋牌游戏，王者荣耀，等等，另外，像一些大型网游，其实也可以看作是房间制，只不过它们这个房间比较特殊，变成了地图，这一个一个的地图就相当于是房间。针对这种房间制的游戏的架构设计，基本的套路都是一样的，至于这个套路是什么，我们后面再详细说明。</p>
</blockquote>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">说起棋牌游戏，你一定会想到一位资深玩家 —— 发哥，想当年，发哥就已经是王者级别的玩家了，现在的段位，应该是 —— 最强王者，哦不，是神级玩家。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">但是，棋牌，棋牌，可不是只有牌类游戏哦，它还包含大量的棋类游戏，比如象棋、军棋、自走棋等等，当然，牌类也不只是扑克，还包括麻将、跑胡子等，基至于，从广义上来说，像捕鱼这种也可以算作是棋牌类的游戏。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">而我们要做的实战项目，是一款叫作麻将的棋牌游戏，大家都很熟悉了。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">好了，说了这么多，下面我们来详细分析一下麻将这个项目吧。</p>
</div><div class="cl-preview-section"><h1 id="需求分析">需求分析</h1>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">麻将，在中国的流行可以说是非常广泛的，同时，也是非常具有地方性特色的一种游戏，每个地方的玩法可能都会有一些差异，比如四川血流成河、贵阳捉鸡、广东推倒胡等。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">当然了，我们不可能完整地做一个麻将游戏出来，我们的课程是 Netty，所以，主要还是说 Netty 如何在游戏中进行使用，当然了，也不会不做一个游戏出来，我们会做一个简化版的麻将，最起码保证可以正常进行游戏。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">按照上一节的理论知识，需求分析阶段应该按照 需求收集 -&gt; 详细分析 -&gt; 可行性分析 三个阶段来完成。</p>
</div><div class="cl-preview-section"><h2 id="需求收集" style="font-size: 30px;">需求收集</h2>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">需求收集就非常简单了，对于麻将类的游戏，最好的竞品就是腾讯的欢乐麻将了，另外，还有其他一些小厂开发的地方性特色的麻将，既然，我们要做简化版的麻将，直接拿腾讯欢乐麻将的规则来做减法就可以了。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">对于腾讯欢乐麻将，我们可以直接在小程序中打开，点击 更多 -&gt; 帮助 即可看到所有欢乐麻将的规则：<br>
<img class="" src="https://img1.sycdn.imooc.com/5f39e0d90001061c20011125.png" data-original="//img1.sycdn.imooc.com/5f39e0d90001061c20011125.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">我这里就不一一截图了，我简单列举一下麻将的普适性规则：</p>
</div><div class="cl-preview-section"><ol>
<li style="font-size: 20px; line-height: 38px;">麻将一般有四个玩家，个别地方可以支持三人或者二人；</li>
<li style="font-size: 20px; line-height: 38px;">麻将一副牌有这么几种牌型：万条筒（序数牌）、东南西北中发白（字牌）、春夏秋冬梅兰竹菊（花牌），共 144 张牌；</li>
<li style="font-size: 20px; line-height: 38px;">二张一样的牌叫对子，三张一样牌的叫刻子，四张一样牌的叫杠，碰出去的叫明刻，手里的叫暗刻，杠别人打出的牌叫明杠，先碰再杠叫补杠，自己摸了四张一样的叫暗杠；</li>
<li style="font-size: 20px; line-height: 38px;">牌局开始会进行洗牌，即打乱牌序；</li>
<li style="font-size: 20px; line-height: 38px;">然后定庄，定庄的规则每个地方不太一样，最常见的掷骰子，按点数算，有的地方掷两次，有的地方掷一次；</li>
<li style="font-size: 20px; line-height: 38px;">接着摸牌，线下是从庄家开始摸，每次摸两墩牌，也就是四张，轮流摸三次后，庄家跳着摸两张，其它玩家各一张，也就是初始摸牌后，庄家有 14 张牌，闲家有 13 张牌，在游戏里，我们称作发牌，发牌的规则不用这么麻烦，直接给庄家发 14 张牌，闲家发 13 张牌即可；</li>
<li style="font-size: 20px; line-height: 38px;">如果发完牌庄家直接胡了，叫天胡；</li>
<li style="font-size: 20px; line-height: 38px;">如果庄家打完第一张牌，闲家胡了，叫地胡；</li>
<li style="font-size: 20px; line-height: 38px;">对于每一次出牌，其他玩家可能有吃、碰、杠、胡、过几种操作，这些操作一般还会有个倒计时，到时间了玩家还没有操作，服务端自动帮玩家操作，多次超时，进入托管状态；</li>
<li style="font-size: 20px; line-height: 38px;">当玩家手里的牌组成了（2+3xN）（3 表示顺子或刻子）的牌型时，则表示可以胡牌了，个别地方支持七对胡；</li>
<li style="font-size: 20px; line-height: 38px;">当玩家手里的牌还差一张就可以胡了的时候，叫作听牌，同时，可以听 1 到多张牌，我见过最吊的，是可以听所有牌（带癞子的玩法），像腾讯欢乐麻将做得比较好，还支持提示听什么牌；</li>
<li style="font-size: 20px; line-height: 38px;">如果胡其他玩家打出的牌，打出这张牌的人叫放炮；</li>
<li style="font-size: 20px; line-height: 38px;">如果胡自己摸的牌，叫自摸；</li>
<li style="font-size: 20px; line-height: 38px;">如果胡别人回头杠的牌，叫抢杠；</li>
<li style="font-size: 20px; line-height: 38px;">如果胡别人开杠摸牌后打的牌，叫杠上炮；</li>
<li style="font-size: 20px; line-height: 38px;">如果胡自己开杠摸的牌，叫杠上开花；</li>
<li style="font-size: 20px; line-height: 38px;">胡牌之后服务器计算番型并发送结算消息给玩家，玩家可以选择离场或者继续；</li>
<li style="font-size: 20px; line-height: 38px;">如果有玩家离场，则等待其他玩家加入，当满足房间人数时，又开始新一轮的游戏；</li>
</ol>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">普适性的规则大概是这样，不过，像血流成河、血战到底等可以无限胡牌或者带癞子的玩法，它们的规则略有出入。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">然后，再看看其它竞品，可以发现，除了上面的规则外，它们很多都支持创建房间这样的制度，这样就很方便亲朋好友一起玩了。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">到这里，需求收集阶段基本上差不多了，下面就进入需求分析阶段了。</p>
</div><div class="cl-preview-section"><h2 id="详细分析" style="font-size: 30px;">详细分析</h2>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">上面介绍的普适性规则，对于我们学 Netty 这门课程来说，还是太多了，所以，结合课程情况，我对这些规则做了一些裁减，裁减后的规则如下：</p>
</div><div class="cl-preview-section"><ol>
<li style="font-size: 20px; line-height: 38px;">使用创建房间的方式游戏，在创建房间时可以选择多少人参与游戏，这样，后面调试的时候会比较简单；</li>
<li style="font-size: 20px; line-height: 38px;">为了方便，只保留万条筒三种序数牌，每种序数牌有 1 到 9，各四张，也就是一共 108 张牌；</li>
<li style="font-size: 20px; line-height: 38px;">定庄，直接让创建房间的人为庄家；</li>
<li style="font-size: 20px; line-height: 38px;">开局发牌时庄家 14 张牌，闲家 13 张牌；</li>
<li style="font-size: 20px; line-height: 38px;">可碰、可杠、可胡、可过，不支持吃；</li>
<li style="font-size: 20px; line-height: 38px;">不支持倒计时；</li>
<li style="font-size: 20px; line-height: 38px;">不支持提示听牌；</li>
<li style="font-size: 20px; line-height: 38px;">没有番型，只按最简单的底分计算输赢分数，底分在创建房间的时候传入；</li>
<li style="font-size: 20px; line-height: 38px;">关于胡牌算法，是一种机密，无法透露，这里使用随机数替代；</li>
<li style="font-size: 20px; line-height: 38px;">一局游戏之后直接结束，不支持继续游戏；</li>
</ol>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">裁减之后的规则就比较简单了，用一张图来表示大致流程：<br>
<img class="" src="https://img1.sycdn.imooc.com/5f39e0ee0001d67a10280517.png" data-original="//img1.sycdn.imooc.com/5f39e0ee0001d67a10280517.png" alt="图片描述"></p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">当然了，我们这里写的还算比较简单的，真正的需求还会写清楚什么情况下可以碰，什么情况下明杠，什么情况下暗杠，等等，不过，我相信大家都有一定了解， 这里为了节约篇幅，就不再赘述了。</p>
</div><div class="cl-preview-section"><h2 id="可行性分析" style="font-size: 30px;">可行性分析</h2>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">通过了详细分析，我们拿到了需求，那是不是就代表这个需求就具有可行性呢？显然不是，想像一下，我们平时做的多少需求都是无意义的，所以，还要进行可行性分析。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">对于可行性分析，站在个人的角度，本次实战项目能够提升个人对于 Netty 的理解，能够提升个人对于游戏开发的了解，是很有意义的，所以，是可行的。站在老板的角度，这里没有老板，所以，嗯，是可行的。</p>
</div><div class="cl-preview-section"><h1 id="后记">后记</h1>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">本节，我们从需求分析的三个阶段出发，详细介绍了本次实战项目的内容，虽然比较简单，但我相信只要遵循这个套路，在平时的工作中，你也可以对产品的需求提出合理的建议和意见，快速促成项目的落地。</p>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;">下一节，我将从系统设计的角度来做好前期的架构设计，敬请期待。</p>
</div><div class="cl-preview-section"><h1 id="思维导图">思维导图</h1>
</div><div class="cl-preview-section"><p style="font-size: 20px; line-height: 38px;"><img class="" src="https://img1.sycdn.imooc.com/5f39e0fa0001b43509820741.png" data-original="//img1.sycdn.imooc.com/5f39e0fa0001b43509820741.png" alt="图片描述"></p>
</div>}
                        </div>
                    </div>
                                            <!-- 买过的阅读 -->
                        <div class="art-next-prev clearfix">
                                                                                                <!-- 已买且开放 或者可以试读 -->
                                    <a href="/read/82/article/2186">
                                                                    <div class="prev l clearfix">
                                        <div class="icon l">
                                            <i class="imv2-arrow3_l"></i>
                                        </div>
                                        <p>
                                             27 软件开发的基本步骤，无套路不欢
                                        </p>
                                    </div>
                                </a>
                                                                                                                            <!-- 已买且开放 或者可以试读 -->
                                    <a href="/read/82/article/2188">
                                                                    <div class="next r clearfix">
                                        <p>
                                            29 系统设计，前期规划很重要
                                        </p>
                                        <div class="icon r">
                                            <i class="imv2-arrow3_r"></i>
                                        </div>

                                    </div>
                                </a>
                                                    </div>
                                    </div>
                <div class="comments-con js-comments-con" id="coments_con">
                </div>

                
            </div>
            
            
            

        </div>
    </div>
</div>

<div class="modal modal-jiaQun-new hide" id="modal-jiaQun">
    <div class="inner" style="">
        <div class="modal-close js-close-jiaQun">
            <i class="imv2-close"></i>
        </div>
        <div class="content">
            <img src="https://img3.sycdn.imooc.com/5f1a7f610001c9a105340522.jpg">
            <div class="right-info">
                <div class="title">
                    扫码加入慕课Java核心用户群
                </div>
                <div class="desc">
                                            <p class="mb6">验证信息：<span id="joincode">2009241134354460</span><span class="copy js-copy-joincode">复制</span></p>
                                        <p class="mb6">QQ讨论群号：314316732</p>
                                            <p>QQ群URL：<a href="https://jq.qq.com/?_wv=1027&amp;k=OouwHZGZ" target="_blank">点击访问</a></p>
                                    </div>
            </div>
            <p class="tip">若遇到搜索不到QQ群或加群失败，请联系客服邮箱:kf@imooc.com</p>
        </div>
    </div>
</div>
 
<!-- 专栏介绍页专栏评价 -->

<!-- 专栏介绍页底部三条评价 -->

<!-- 专栏阅读页弹层目录和介绍页页面目录 -->

<!-- 专栏阅读页发布回复 -->

<!-- 专栏阅读页发布评论 -->

<!-- 专栏阅读页底部评论 -->

<!-- 专栏阅读 单个 评论 -->

<!-- 新增回复和展开三条以外回复 -->

<!-- 立即订阅的弹窗 -->












</div></body></html>